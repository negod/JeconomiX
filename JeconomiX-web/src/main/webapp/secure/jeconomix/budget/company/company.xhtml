<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
    </h:head>
    <h:body>
        <ui:include src="/secure/commons/messages.xhtml"/>
        <h:form id="#{viewId.companyForm}">            
            <p:dataTable id="#{viewId.companyTable}" 
                         var="company" 
                         value="#{companyBacking.tableModel}" 
                         widgetVar="#{viewVar.companyTable}" 
                         emptyMessage="#{companyMsg.cannotFindDataWithProperties}" 
                         filteredValue="#{companyBacking.filteredTableData}" 
                         selectionMode="single"
                         selection="#{companyBacking.selectedTableData}"
                         paginator="true"
                         rows="20">

                <p:ajax event="rowSelect" 
                        update=":#{viewId.companyForm}:#{viewId.editCompanyDialog}"
                        oncomplete="#{viewVar.editCompanyDialog}.show()"
                        listener="#{companyBacking.onRowSelect}"/>              

                <f:facet name="header">
                    <p:outputPanel>
                        <h:outputText value="#{companyMsg.tableSearchTitle}" />
                        <p:inputText id="globalFilter" 
                                     onkeyup="#{viewVar.companyTable}.filter()" 
                                     style="width:150px" />
                    </p:outputPanel>
                </f:facet>

                <p:column id="companyNameColumn" 
                          filterBy="#{company.companyName}"
                          headerText="#{companyMsg.companyName}">
                    <h:outputText value="#{company.companyName}" />
                </p:column>

            </p:dataTable>
            <p:panelGrid id="createNewUserPanel" columns="1" >                
                <p:commandButton value="#{companyMsg.add}" 
                                 oncomplete="#{viewVar.createCompanyDialog}.show()"
                                 update="#{viewId.createCompanyDialog}"
                                 ajax="true"/>
            </p:panelGrid>

            <!-- EDIT Company -->
            <ui:include src="/secure/jeconomix/budget/company/dialogs/editCompany.xhtml">
                <ui:param name="dialogID" value="#{viewId.editCompanyDialog}"/>
                <ui:param name="dialogVar" value="#{viewVar.editCompanyDialog}"/>
                <ui:param name="companyTableId" value="#{viewId.companyTable}"/>
                <ui:param name="backing" value="#{companyBacking}"/>
            </ui:include>  

            <!-- ADD Company -->
            <ui:include src="/secure/jeconomix/budget/company/dialogs/createCompany.xhtml">
                <ui:param name="dialogID" value="#{viewId.createCompanyDialog}"/>
                <ui:param name="dialogVar" value="#{viewVar.createCompanyDialog}"/>
                <ui:param name="companyTableID" value="#{viewId.companyTable}"/>
                <ui:param name="backing" value="#{companyBacking}"/>
            </ui:include>

        </h:form>

    </h:body>
</html>
